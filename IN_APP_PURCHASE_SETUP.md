# 💰 인앱 결제(후원 상점) 설정 가이드

## ✅ 현재 구현 상태

### 코드에서 확인된 내용
- **인앱 결제 패키지**: `in_app_purchase: ^3.2.0` ✅
- **상품 ID**: `donation_1000` ✅
- **상품 타입**: Non-Consumable (비소모성) ✅
- **UI**: 설정 페이지에 "후원하기" 버튼 있음 ✅

---

## 🍎 iOS (App Store Connect) 설정

### 1단계: App Store Connect 접속
1. [App Store Connect](https://appstoreconnect.apple.com) 접속
2. Apple Developer 계정으로 로그인

### 2단계: 앱 선택
1. **내 앱** 클릭
2. **Petgram** 앱 선택 (또는 새로 만든 앱)
3. 앱이 없으면 먼저 앱 생성 필요

### 3단계: 인앱 구매 상품 등록
1. 왼쪽 메뉴에서 **기능** 클릭
2. **인앱 구매** 섹션에서 **+** 버튼 클릭
3. **새 인앱 구매 만들기** 클릭

### 4단계: 상품 정보 입력

#### 기본 정보
- **참조 이름**: `후원 1000원` (관리용 이름)
- **상품 ID**: `donation_1000` ⚠️ **코드와 정확히 일치해야 함**
- **타입**: **비소모성 인앱 구매** 선택
  - 코드에서 `buyNonConsumable` 사용 중

#### 가격 및 가용성
- **가격**: 원하는 가격 선택 (예: ₩1,000)
- **가용성**: 모든 국가 또는 특정 국가 선택

#### 현지화 정보
- **표시 이름**: `후원하기` (사용자에게 보이는 이름)
- **설명**: `앱 개발을 후원해주세요. 감사합니다! 💕`
- **언어**: 한국어 추가

### 5단계: 검토 제출
1. 모든 정보 입력 완료
2. **저장** 클릭
3. **검토를 위해 제출** 클릭
4. Apple 검토 대기 (보통 1-2일)

---

## 📱 Android (Google Play Console) 설정

### 1단계: Google Play Console 접속
1. [Google Play Console](https://play.google.com/console) 접속
2. Google 계정으로 로그인

### 2단계: 앱 선택
1. 앱 선택 (또는 새로 만든 앱)
2. 앱이 없으면 먼저 앱 생성 필요

### 3단계: 인앱 상품 등록
1. 왼쪽 메뉴에서 **수익 창출** > **인앱 상품** 클릭
2. **인앱 상품 만들기** 클릭

### 4단계: 상품 정보 입력

#### 기본 정보
- **상품 ID**: `donation_1000` ⚠️ **코드와 정확히 일치해야 함**
- **이름**: `후원하기`
- **설명**: `앱 개발을 후원해주세요. 감사합니다! 💕`
- **상태**: 활성화

#### 가격
- **가격**: 원하는 가격 설정 (예: ₩1,000)
- **자동 갱신 구독**: 아니오 (일회성 결제)

### 5단계: 저장 및 활성화
1. 모든 정보 입력 완료
2. **저장** 클릭
3. 상품이 **활성화** 상태가 되면 사용 가능

---

## 🔍 코드 확인

### 현재 설정된 상품 ID
```dart
// lib/main.dart 4807번째 줄
const Set<String> productIds = {'donation_1000'};
```

### 상품 타입
```dart
// lib/main.dart 4856번째 줄
_inAppPurchase.buyNonConsumable(...)
```
- **Non-Consumable**: 한 번 구매하면 계속 소유 (후원에 적합)

---

## ✅ 체크리스트

### iOS (App Store Connect)
- [ ] App Store Connect 접속
- [ ] 앱 선택 (Petgram)
- [ ] 기능 > 인앱 구매 > 새 인앱 구매 만들기
- [ ] 상품 ID: `donation_1000` 입력
- [ ] 타입: 비소모성 인앱 구매 선택
- [ ] 가격 설정
- [ ] 현지화 정보 입력 (한국어)
- [ ] 검토 제출

### Android (Google Play Console)
- [ ] Google Play Console 접속
- [ ] 앱 선택
- [ ] 수익 창출 > 인앱 상품 > 인앱 상품 만들기
- [ ] 상품 ID: `donation_1000` 입력
- [ ] 이름 및 설명 입력
- [ ] 가격 설정
- [ ] 저장 및 활성화

---

## 🎯 중요 사항

### 1. 상품 ID 정확히 일치
- 코드: `donation_1000`
- App Store Connect: `donation_1000` ✅
- Google Play Console: `donation_1000` ✅
- **대소문자, 언더스코어 모두 정확히 일치해야 함**

### 2. 상품 타입
- 코드에서 `buyNonConsumable` 사용
- App Store Connect: **비소모성 인앱 구매** 선택
- Google Play Console: **일회성 결제** (자동 갱신 구독 아님)

### 3. 검토 시간
- **iOS**: Apple 검토 필요 (1-2일)
- **Android**: 즉시 활성화 가능

### 4. 테스트
- **iOS**: Sandbox 테스트 계정으로 테스트
- **Android**: 라이선스 테스트 계정으로 테스트

---

## 🧪 테스트 방법

### iOS Sandbox 테스트
1. App Store Connect > 사용자 및 액세스 > 샌드박스 테스터
2. 테스트 계정 추가
3. 기기에서 로그아웃 후 Sandbox 계정으로 로그인
4. 앱에서 후원하기 버튼 클릭하여 테스트

### Android 라이선스 테스트
1. Google Play Console > 설정 > 라이선스 테스트
2. 테스트 계정 추가
3. 앱에서 후원하기 버튼 클릭하여 테스트

---

## 📝 추가 상품 등록 (선택사항)

더 많은 후원 금액을 추가하려면:

1. **코드 수정**
   ```dart
   const Set<String> productIds = {
     'donation_1000',
     'donation_5000',  // 추가
     'donation_10000', // 추가
   };
   ```

2. **App Store Connect / Google Play Console에서 각각 등록**

---

## 🆘 문제 해결

### "상품이 등록되지 않았습니다" 오류
- **원인**: 상품 ID 불일치 또는 상품 미등록
- **해결**: 
  1. App Store Connect / Google Play Console에서 상품 ID 확인
  2. 코드의 상품 ID와 정확히 일치하는지 확인
  3. 상품이 검토 완료되었는지 확인

### "인앱 결제를 사용할 수 없습니다" 오류
- **원인**: 인터넷 연결 문제 또는 서비스 비활성화
- **해결**: 인터넷 연결 확인

---

## 🎉 완료!

상품 등록이 완료되면:
1. 앱에서 "후원하기" 버튼 클릭
2. 상품 정보가 표시됨
3. 결제 진행 가능

**먼저 App Store Connect에서 상품을 등록하세요!**

